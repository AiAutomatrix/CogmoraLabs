
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile within the Cogmora Labs application.",
      "properties": {
        "uid": {
          "type": "string",
          "description": "The user's unique ID, from Firebase Authentication."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "The display name of the user."
        },
        "photoURL": {
          "type": "string",
          "description": "URL of the user's profile photo.",
          "format": "uri"
        },
        "createdAt": {
          "type": "object",
          "description": "Firestore server timestamp of when the user profile was created."
        }
      },
      "required": [
        "uid",
        "email",
        "createdAt"
      ]
    },
    "PaperTradingContext": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PaperTradingContext",
      "type": "object",
      "description": "Represents the core settings of a user's paper trading environment. This is a singleton document per user.",
      "properties": {
        "balance": {
          "type": "number",
          "description": "The user's current cash balance for paper trading."
        },
        "automationConfig": {
          "type": "object",
          "description": "Configuration for the automated watchlist scraper."
        },
        "aiSettings": {
          "type": "object",
          "description": "Settings for the AI trading agent."
        },
        "lastAiActionPlan": {
          "type": "object",
          "description": "The last plan proposed by the AI agent, for state persistence.",
          "nullable": true
        },
        "aiActionLogs": {
           "type": "array",
           "description": "A log of all AI actions executed by the user.",
           "items": { "type": "object" }
        }
      },
      "required": [
        "balance",
        "automationConfig",
        "aiSettings"
      ]
    },
    "OpenPosition": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "OpenPosition",
      "type": "object",
      "description": "Represents an open trading position in the user's portfolio.",
      "properties": {
        "id": { "type": "string" },
        "positionType": { "type": "string", "enum": ["spot", "futures"] },
        "symbol": { "type": "string" },
        "symbolName": { "type": "string" },
        "size": { "type": "number" },
        "averageEntryPrice": { "type": "number" },
        "currentPrice": { "type": "number" },
        "side": { "type": "string", "enum": ["buy", "long", "short"] },
        "leverage": { "type": "number" },
        "unrealizedPnl": { "type": "number" },
        "priceChgPct": { "type": "number" },
        "liquidationPrice": { "type": "number" },
        "details": { "type": "object" }
      },
      "required": ["id", "symbol", "size", "averageEntryPrice"]
    },
    "PaperTrade": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PaperTrade",
      "type": "object",
      "description": "Represents a single trade execution, logged for history.",
      "properties": {
        "id": { "type": "string" },
        "positionId": { "type": "string" },
        "symbol": { "type": "string" },
        "size": { "type": "number" },
        "price": { "type": "number" },
        "side": { "type": "string" },
        "timestamp": { "type": "number" },
        "status": { "type": "string", "enum": ["open", "closed"] }
      },
       "required": ["id", "positionId", "symbol", "price", "timestamp"]
    },
    "WatchlistItem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WatchlistItem",
      "type": "object",
      "description": "Represents a single symbol in the user's watchlist.",
      "properties": {
        "symbol": { "type": "string" },
        "symbolName": { "type": "string" },
        "type": { "type": "string", "enum": ["spot", "futures"] },
        "currentPrice": { "type": "number" }
      },
      "required": ["symbol", "symbolName", "type"]
    },
    "TradeTrigger": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TradeTrigger",
      "type": "object",
      "description": "Represents a conditional trade trigger.",
      "properties": {
        "id": { "type": "string" },
        "symbol": { "type": "string" },
        "condition": { "type": "string", "enum": ["above", "below"] },
        "targetPrice": { "type": "number" },
        "action": { "type": "string" },
        "amount": { "type": "number" }
      },
      "required": ["id", "symbol", "targetPrice", "action", "amount"]
    },
    "PriceAlert": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PriceAlert",
      "type": "object",
      "description": "Represents a simple price alert for a symbol.",
      "properties": {
        "price": { "type": "number" },
        "condition": { "type": "string", "enum": ["above", "below"] },
        "triggered": { "type": "boolean" }
      },
      "required": ["price", "condition", "triggered"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/UserProfile" },
      "description": "Top-level collection for all user data. Document ID is the Firebase Auth UID."
    },
    "/users/{userId}/paperTradingContext/main": {
      "schema": { "$ref": "#/entities/PaperTradingContext" },
      "description": "A singleton document holding the main paper trading state for a user."
    },
    "/users/{userId}/paperTradingContext/main/openPositions/{positionId}": {
      "schema": { "$ref": "#/entities/OpenPosition" },
      "description": "Subcollection for a user's open trading positions."
    },
    "/users/{userId}/paperTradingContext/main/tradeHistory/{tradeId}": {
      "schema": { "$ref": "#/entities/PaperTrade" },
      "description": "Subcollection for a user's historical trades."
    },
    "/users/{userId}/paperTradingContext/main/watchlist/{symbol}": {
      "schema": { "$ref": "#/entities/WatchlistItem" },
      "description": "Subcollection for a user's watchlist. Document ID is the symbol."
    },
    "/users/{userId}/paperTradingContext/main/tradeTriggers/{triggerId}": {
      "schema": { "$ref": "#/entities/TradeTrigger" },
      "description": "Subcollection for a user's active trade triggers."
    },
    "/users/{userId}/paperTradingContext/main/priceAlerts/{symbol}": {
      "schema": { "$ref": "#/entities/PriceAlert" },
      "description": "Subcollection for a user's simple price alerts."
    }
  }
}
