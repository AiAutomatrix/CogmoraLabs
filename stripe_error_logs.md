
[BillingPopup] handlePurchase started for productId: AI_CREDIT_PACK_100 
[BillingPopup] Getting user ID token. 
[BillingPopup] Got user ID token. 
[BillingPopup] API response status: 500 
[BillingPopup] API responded with an error: <!DOCTYPE html><html><head><style data-next-hide-fouc="true">body{display:none}</style><noscript data-next-hide-fouc="true"><style>body{display:block}</style></noscript><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/node_modules_next_dist_build_polyfills_polyfill-nomodule.js"></script><script src="/_next/static/chunks/%5Broot%20of%20the%20server%5D__3a40d6d2._.js" defer=""></script><script src="/_next/static/chunks/node_modules_react_b2385d85._.js" defer=""></script><script src="/_next/static/chunks/node_modules_react-dom_cjs_react-dom_development_ab7e073c.js" defer=""></script><script src="/_next/static/chunks/node_modules_react-dom_f14d0471._.js" defer=""></script><script src="/_next/static/chunks/node_modules_69e050bc._.js" defer=""></script><script src="/_next/static/chunks/%5Broot%20of%20the%20server%5D__49fd8634._.js" defer=""></script><script src="/_next/static/chunks/pages__app_5771e187._.js" defer=""></script><script src="/_next/static/chunks/pages__app_83ccb444._.js" defer=""></script><script src="/_next/static/chunks/%5Broot%20of%20the%20server%5D__73499ecc._.js" defer=""></script><script src="/_next/static/chunks/%5Broot%20of%20the%20server%5D__923cb372._.js" defer=""></script><script src="/_next/static/chunks/pages__error_5771e187._.js" defer=""></script><script src="/_next/static/chunks/pages__error_5529b1fc._.js" defer=""></script><script src="/_next/static/development/_ssgManifest.js" defer=""></script><script src="/_next/static/development/_buildManifest.js" defer=""></script><noscript id="__next_css__DO_NOT_USE__"></noscript></head><body><div id="__next"></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"statusCode":500,"hostname":"0.0.0.0"}},"page":"/_error","query":{},"buildId":"development","isFallback":false,"err":{"name":"TypeError","source":"server","message":"Cannot read properties of undefined (reading 'INTERNAL')","stack":"TypeError: Cannot read properties of undefined (reading 'INTERNAL')\n    at initializeApp (/home/user/studio/node_modules/firebase-admin/lib/app/firebase-namespace.js:246:21)\n    at getAdminApp (/home/user/studio/.next/server/chunks/[root of the server]__ea2477b6._.js:103:161)\n    at [project]/src/firebase/admin.ts [app-route] (ecmascript) (/home/user/studio/.next/server/chunks/[root of the server]__ea2477b6._.js:106:18)\n    at instantiateModule (/home/user/studio/.next/server/chunks/[turbopack]_runtime.js:593:23)\n    at getOrInstantiateModuleFromParent (/home/user/studio/.next/server/chunks/[turbopack]_runtime.js:652:12)\n    at esmImport (/home/user/studio/.next/server/chunks/[turbopack]_runtime.js:132:20)\n    at [project]/src/app/api/stripe/checkout/route.ts [app-route] (ecmascript) (/home/user/studio/.next/server/chunks/[root of the server]__ea2477b6._.js:120:152)\n    at instantiateModule (/home/user/studio/.next/server/chunks/[turbopack]_runtime.js:593:23)\n    at getOrInstantiateModuleFromParent (/home/user/studio/.next/server/chunks/[turbopack]_runtime.js:652:12)\n    at esmImport (/home/user/studio/.next/server/chunks/[turbopack]_runtime.js:132:20)\n    at [project]/node_modules/next/dist/esm/build/templates/app-route.js { INNER_APP_ROUTE =\u003e \"[project]/src/app/api/stripe/checkout/route.ts [app-route] (ecmascript)\" } [app-route] (ecmascript) (/home/user/studio/.next/server/chunks/node_modules_next_f6fe7f25._.js:13025:176)\n    at instantiateModule (/home/user/studio/.next/server/chunks/[turbopack]_runtime.js:593:23)\n    at instantiateRuntimeModule (/home/user/studio/.next/server/chunks/[turbopack]_runtime.js:660:12)\n    at Object.getOrInstantiateRuntimeModule (/home/user/studio/.next/server/chunks/[turbopack]_runtime.js:676:12)\n    at Object.\u003canonymous\u003e (/home/user/studio/.next/server/app/api/stripe/checkout/route.js:6:9)\n    at Module._compile (node:internal/modules/cjs/loader:1529:14)\n    at Module._extensions..js (node:internal/modules/cjs/loader:1613:10)\n    at Module.load (node:internal/modules/cjs/loader:1275:32)\n    at Module._load (node:internal/modules/cjs/loader:1096:12)\n    at Module.require (node:internal/modules/cjs/loader:1298:19)\n    at mod.require (/home/user/studio/node_modules/next/dist/server/require-hook.js:65:28)\n    at require (node:internal/modules/helpers:182:18)\n    at requirePage (/home/user/studio/node_modules/next/dist/server/require.js:103:84)\n    at loadComponentsImpl (/home/user/studio/node_modules/next/dist/server/load-components.js:129:57)\n    at async DevServer.findPageComponentsImpl (/home/user/studio/node_modules/next/dist/server/next-server.js:808:36)\n    at async DevServer.findPageComponents (/home/user/studio/node_modules/next/dist/server/dev/next-dev-server.js:628:16)\n    at async DevServer.renderPageComponent (/home/user/studio/node_modules/next/dist/server/base-server.js:2379:24)\n    at async DevServer.renderToResponseImpl (/home/user/studio/node_modules/next/dist/server/base-server.js:2430:32)\n    at async DevServer.pipeImpl (/home/user/studio/node_modules/next/dist/server/base-server.js:1003:25)\n    at async NextNodeServer.handleCatchallRenderRequest (/home/user/studio/node_modules/next/dist/server/next-server.js:304:17)\n    at async DevServer.handleRequestImpl (/home/user/studio/node_modules/next/dist/server/base-server.js:895:17)\n    at async /home/user/studio/node_modules/next/dist/server/dev/next-dev-server.js:371:20\n    at async Span.traceAsyncFn (/home/user/studio/node_modules/next/dist/trace/trace.js:157:20)\n    at async DevServer.handleRequest (/home/user/studio/node_modules/next/dist/server/dev/next-dev-server.js:368:24)\n    at async invokeRender (/home/user/studio/node_modules/next/dist/server/lib/router-server.js:247:21)\n    at async handleRequest (/home/user/studio/node_modules/next/dist/server/lib/router-server.js:438:24)\n    at async requestHandlerImpl (/home/user/studio/node_modules/next/dist/server/lib/router-server.js:462:13)\n    at async Server.requestListener (/home/user/studio/node_modules/next/dist/server/lib/start-server.js:158:13)"},"gip":true,"scriptLoader":[]}</script></body></html>

Purchase Error: Server responded with 500. Check console for details.